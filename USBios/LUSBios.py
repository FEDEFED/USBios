working='''
########################################################################################################################
#                                                                                                                      #
#                                /\ \/\ \/\  _`\ /\  _`\    __                                                         #
#                                \ \ \ \ \ \,\_\_\ \ \_\ \ /\_\    ___     ____                                        #
#                                 \ \ \ \ \/_\__ \\\\ \  _ <'\/\ \  / __`\  /',__\                                       #
#                                  \ \ \_\ \/\ \_\ \ \ \_\ \\\\ \ \/\ \_\ \/\__, `\                                      #
#                                   \ \_____\ `\____\ \____/ \ \_\ \____/\/\____/                                      #
#                                    \/_____/\/_____/\/___/   \/_/\/___/  \/___/     V=0.1                             #
#                                                                                                                      #
#----------------------------------------------------------------------------------------------------------------------#
#                                              Usb Injection Tool                                                      #
#                                               by BlackThether                                                        #
#----------------------------------------------------------------------------------------------------------------------#
# In order to pass a payload we need to have this data sections                                                        #
# |data|=|crc16(0)|eop|payload|sync|pid|                                                                               #
# so that                                                                                                              #
# |datapacket|=|sync|pid|(|crc16(0)|eop|  payload   |sync|pid|)|crc16(something not 0)|eop|                            #
#                                                                                                                      #
# wath this do: |sync|pid|0|crc16(0)|eop|              payload              |sync|pid|0|crc16(something not 0)|eop|    #
#                         |                               |                                     |                      #
#                 (send an empty data)            (does something)            (fails couse of crc16 so is ignored)     #
#                    (does nothing)                                                                                    #
#                                                                                                                      #
# note that the only thing that does something is the payload                                                          #
#                                                                                                                      #
# in payload we can use 1023-crc16-eop-sync-pid=1023-16-3-8-8=988 bits of data, wich is not a lot, but enought for an  #
# hid attack (via file copying)                                                                                        #
#                                                                                                                      #
########################################################################################################################
                                              |  |  |  |  |  |  |  | 
                              ####################################################
                              #--------------------------------------------------#
                              #                    Syntax                        #
                              #--------------------------------------------------#
                              #              You have to write:                  #
                              #        [Attack Type Letter][Payload]             #
                              #                                                  #
                              #          ___Attack Type Letters___               #------------
                              #                                                  #----------- |
                              #           H: HID attack (Keyboard)               #          | |
                              ####################################################          | |
                                                                                           \   / 
                                                                                            \ /
'''
parasing='''
#####################################################
#       _____                    _                  #
#      |  __ \                  (_)                 #
#      | |__) |_ _ _ __ __ _ ___ _ _ __   __ _      #
#      |  ___/ _` | '__/ _` / __| | '_ \ / _` |     #
#      | |  | (_| | | | (_| \__ \ | | | | (_| |     #
#      |_|   \__,_|_|  \__,_|___/_|_| |_|\__, |     #
#                                         __/ |     #
#                                        |___/      #
#####################################################
'''
adding='''
#####################################################
#     /\      | |   | (_)                           #
#    /  \   __| | __| |_ _ __   __ _   _   _ _ __   #
#   / /\ \ / _` |/ _` | | '_ \ / _` | | | | | '_ \  #
#  / ____ \ (_| | (_| | | | | | (_| | | |_| | |_) | #
# /_/    \_\__,_|\__,_|_|_| |_|\__, |  \__,_| .__/  #
#                               __/ |       | |     #
#                              |___/        |_|     #
#          _____           _        _               #
#         |  __ \         | |      | |              #
#         | |__) |_ _  ___| | _____| |_ ___         #
#         |  ___/ _` |/ __| |/ / _ \ __/ __|        #
#         | |  | (_| | (__|   <  __/ |_\__ \        #
#         |_|   \__,_|\___|_|\_\___|\__|___/        #                     
#####################################################


'''
writing='''
#####################################################
#     __          __   _ _   _                      #
#     \ \        / /  (_) | (_)                     #
#      \ \  /\  / / __ _| |_ _ _ __   __ _          #
#       \ \/  \/ / '__| | __| | '_ \ / _` |         #
#        \  /\  /| |  | | |_| | | | | (_| |         #
#         \/  \/ |_|  |_|\__|_|_| |_|\__, |         #
#                                     __/ |         #
#                                     |___/         #
#####################################################
'''
done='''
'########:::'#######::'##::: ##:'########:
 ##.... ##:'##.... ##: ###:: ##: ##.....::
 ##:::: ##: ##:::: ##: ####: ##: ##:::::::
 ##:::: ##: ##:::: ##: ## ## ##: ######:::
 ##:::: ##: ##:::: ##: ##. ####: ##...::::
 ##:::: ##: ##:::: ##: ##:. ###: ##:::::::
 ########::. #######:: ##::. ##: ########:
........::::.......:::..::::..::........::
'''







print(working)

def parase(payload): 
    print(parasing)
    mode=payload[0]
    payload=payload[1:]
    startdata,enddata,beg,en=modifiers[mode]
    a=[]
    a.extend(startdata)
    a.extend([beg+i+en for i in payload.split(',')])
    a.extend(enddata)
    print(adding)
    return a

modifiers={'H':[['friststartcall','secondstartcall'],['fristendcall','end'],'beg','end']}




crc0='0000000000000000'
eop='001'
sync='01010100'
pid='11010010'

begin=crc0+eop
end=sync+pid

# Simple to understand but not fast way
#
#
#file=''
#for i in parase(input('Payload: ')):
#    file+=begin+i+end
#
# The same but more pythonic



file=begin+(end+begin).join(parase(input('                                                                                    **Payload here:** ')))+end

#print(file)
print(writing)
print(done)

